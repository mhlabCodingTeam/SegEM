layer = 6;
figure;
subplot(2,2,1);
cnet = cnn(4,[10 10 10 10], [10 10 10], train([10 10 10], '/home/mberning/', 1e6, 1e-2, 1e-2), 0, 0, 0, 1);
cnet = cnet.init;
weights = cat(4,cnet.layer{layer}.W{:});
hist(weights(:));
title('SegEM original');
subplot(2,2,2);
cnet = cnn(4,[10 10 10 10], [10 10 10], train([10 10 10], '/home/mberning/', 1e6, 1e-2, 1e-2), 1, 0, 0, 1);
cnet = cnet.init;
weights = cat(4,cnet.layer{layer}.W{:});
hist(weights(:));
title('SegEM fan-in');
subplot(2,2,3);
cnet = cnn(4,[10 10 10 10], [10 10 10], train([10 10 10], '/home/mberning/', 1e6, 1e-2, 1e-2), 0, 1, 0, 1);
cnet = cnet.init;
weights = cat(4,cnet.layer{layer}.W{:});
hist(weights(:));
title('SegEM fan-out');
subplot(2,2,4);
cnet = cnn(4,[10 10 10 10], [10 10 10], train([10 10 10], '/home/mberning/', 1e6, 1e-2, 1e-2), 0, 0, 1, 1);
cnet = cnet.init;
weights = cat(4,cnet.layer{layer}.W{:});
hist(weights(:));
title('SegEM He et al.');